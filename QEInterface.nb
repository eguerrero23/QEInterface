(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    100008,       2272]
NotebookOptionsPosition[     96589,       2225]
NotebookOutlinePosition[     97084,       2243]
CellTagsIndexPosition[     97041,       2240]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"MODULE", " ", "BEGINS"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "-"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "-"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "-"}]}]}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.819909467272047*^9, 3.819909470341835*^9}, {
  3.820616236751568*^9, 3.820616260775345*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"168efd4a-8366-436a-b2f5-b29f54c2fae9"],

Cell[BoxData[
 RowBox[{"(*", "*)"}]], "Input",
 CellChangeTimes->{{3.822775675592993*^9, 
  3.8227756760534105`*^9}},ExpressionUUID->"629612a0-71a5-4b6e-bcb0-\
9d7953315856"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "List", " ", "of", " ", "possible", " ", "association", " ", "values", " ",
     "for", " ", 
    RowBox[{"qedict", ":", "\[IndentingNewLine]", "\"\<calcType\>\""}]}], ";",
    " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<scf\>\"", " ", "or", " ", "\"\<vc-relax\>\""}], "}"}], 
    "\[IndentingNewLine]", "\"\<listFiles\>\""}], ";", "\[IndentingNewLine]", 
   "\"\<energy\>\"", ";", "\[IndentingNewLine]", "\"\<atoms\>\"", ";", "\n", 
   "\"\<cells\>\"", ";", "\[IndentingNewLine]", "\"\<structures\>\"", ";", 
   "\[IndentingNewLine]", "\"\<numberOfAtoms\>\"", ";", 
   "\[IndentingNewLine]", "\"\<numberOfIterations\>\"", ";", 
   "\[IndentingNewLine]", "\"\<alat\>\"", ";", "\[IndentingNewLine]", 
   "\"\<cellUnits\>\"", ";", "\[IndentingNewLine]", "\"\<coordinateUnits\>\"",
    ";"}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.820616364639125*^9, 3.820616506436236*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"b43fd578-ef3f-4781-a934-80adf8bf99a1"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Visual", " ", "options"}], "*)"}]], "Input",
 CellChangeTimes->{{3.820616268641951*^9, 3.820616272710723*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"1287f675-a785-4403-9ec7-dac1eb49d413"],

Cell[BoxData[
 RowBox[{
  RowBox[{"elementColor", " ", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<Ni\>\"", "\[Rule]", "Red"}], ",", " ", 
     RowBox[{"\"\<Si\>\"", "\[Rule]", " ", 
      RowBox[{"Lighter", "[", "Blue", "]"}]}], ",", " ", 
     RowBox[{"\"\<Mo\>\"", "\[Rule]", " ", "Gray"}], ",", " ", 
     RowBox[{"\"\<S\>\"", "\[Rule]", " ", 
      RowBox[{"Darker", "[", "Yellow", "]"}]}], ",", 
     RowBox[{"\"\<C\>\"", "\[Rule]", " ", "Black"}], ",", " ", 
     RowBox[{"\"\<H\>\"", "\[Rule]", " ", "White"}], ",", " ", 
     RowBox[{"\"\<Re\>\"", "\[Rule]", " ", "Purple"}]}], "|>"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.820600945536484*^9, 3.820600956606325*^9}, {
  3.820601043949607*^9, 3.820601096765153*^9}, {3.820605774481801*^9, 
  3.82060577817049*^9}, {3.8207957066640773`*^9, 3.8207957158941183`*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"596a36f0-2c88-4af0-97dc-e369b665b813"],

Cell[BoxData[
 RowBox[{
  RowBox[{"elementRadius", " ", "=", " ", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<Ni\>\"", "\[Rule]", " ", "1.0"}], ",", " ", 
     RowBox[{"\"\<Si\>\"", "\[Rule]", " ", "1.0"}], ",", " ", 
     RowBox[{"\"\<Mo\>\"", "\[Rule]", " ", "1.1"}], ",", " ", 
     RowBox[{"\"\<S\>\"", "\[Rule]", " ", "0.95"}], ",", " ", 
     RowBox[{"\"\<C\>\"", "\[Rule]", " ", "0.85"}], ",", " ", 
     RowBox[{"\"\<H\>\"", "\[Rule]", " ", "0.7"}], ",", " ", 
     RowBox[{"\"\<Re\>\"", "\[Rule]", " ", "1.2"}]}], "|>"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.820605726412631*^9, 3.820605781268303*^9}, {
  3.820795697455874*^9, 3.8207957017180767`*^9}},
 CellLabel->
  "In[249]:=",ExpressionUUID->"14239965-603b-4c28-a239-455c47d5e2ec"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{"base", " ", "useful", " ", "functions"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8206175747385187`*^9, 3.820617579312729*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"2640ca51-c79c-457d-bfa0-1640442cbf0f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ry", " ", "=", " ", "13.605662285137"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bohr", " ", "=", " ", "0.529177249"}], ";"}]}], "Input",
 CellChangeTimes->{{3.820633475336209*^9, 3.820633477452431*^9}, {
  3.8214612069642897`*^9, 3.8214612122270684`*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"1dc5c2eb-8cbe-4d86-a6a0-164ac847aa77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convAtomsCrysToAng", "[", 
   RowBox[{"atoms_", ",", " ", "cell_"}], "]"}], ":=", " ", 
  RowBox[{"Transpose", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"atoms", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "}"}], "~", "Join", "~", 
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "cell", "]"}], ".", "#"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"atoms", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", 
          RowBox[{"2", ";;"}]}], "]"}], "]"}], ")"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8206175836096306`*^9, 3.820617631575796*^9}, {
  3.820617833206262*^9, 3.820617858101302*^9}, {3.8206179314368005`*^9, 
  3.820617950644833*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"71ce3c97-613c-4bfe-bfba-98b0464ca09b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convAtomsAngToCrys", "[", 
   RowBox[{"atoms_", ",", " ", "cell_"}], "]"}], ":=", " ", 
  RowBox[{"Transpose", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"atoms", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "}"}], "~", "Join", "~", 
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"Transpose", "[", "cell", "]"}], "]"}], ".", "#"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"atoms", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", 
          RowBox[{"2", ";;"}]}], "]"}], "]"}], ")"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.820617615962001*^9, 3.820617628808344*^9}, {
  3.8206179574851055`*^9, 3.820617968597006*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"e36431ff-1eac-4ceb-a97a-88f641eef4e4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"base", " ", "parsing", " ", "functions"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8206162790154533`*^9, 3.8206162927589235`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"6da9df1f-685d-42a3-b7db-18e07e84314d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"grep", "[", 
    RowBox[{"filename_", ",", " ", "regex_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"outStr", " ", "=", " ", "\"\<\>\""}], ",", " ", "istream", 
       ",", " ", "i", ",", " ", "tmp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"istream", " ", "=", " ", 
       RowBox[{"OpenRead", "[", "filename", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", " ", "=", " ", 
       RowBox[{"Find", "[", 
        RowBox[{"istream", ",", " ", "regex"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"SameQ", "[", 
          RowBox[{"tmp", ",", " ", "EndOfFile"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"outStr", "=", "  ", 
          RowBox[{"outStr", "<>", 
           RowBox[{"ToString", "[", "tmp", "]"}], "<>", "\"\<\\n\>\""}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", " ", "=", " ", 
          RowBox[{"Find", "[", 
           RowBox[{"istream", ",", " ", "regex"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "istream", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "outStr", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8206123528836823`*^9, 3.820612460816976*^9}, {
  3.8206125431610394`*^9, 3.820612550808211*^9}, {3.82061496847127*^9, 
  3.8206149706772733`*^9}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"0069d8a1-418b-4e2f-9dee-3e5f8e16cdec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grepAfter", "[", 
   RowBox[{"filename_", ",", " ", "regex_", ",", " ", "a_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"outStr", "=", " ", "\"\<\>\""}], ",", " ", "istream", ",", " ",
       "i", ",", " ", "tmp"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"istream", " ", "=", " ", 
      RowBox[{"OpenRead", "[", "filename", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", " ", "=", " ", 
      RowBox[{"Find", "[", 
       RowBox[{"istream", ",", " ", "regex"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"SameQ", "[", 
         RowBox[{"tmp", ",", "  ", "EndOfFile"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", " ", "a"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"outStr", " ", "=", " ", 
            RowBox[{"outStr", " ", "<>", 
             RowBox[{"Read", "[", 
              RowBox[{"istream", ",", " ", "String"}], "]"}], "<>", 
             "\"\<\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", " ", "=", " ", 
         RowBox[{"Find", "[", 
          RowBox[{"istream", ",", " ", "regex"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "istream", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outStr", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.8199330286165123`*^9, {3.8199339367591553`*^9, 3.819933961303443*^9}, {
   3.8199340641097965`*^9, 3.819934073774572*^9}, {3.8199341342775126`*^9, 
   3.819934256940897*^9}, {3.819934309677785*^9, 3.8199343099480305`*^9}, {
   3.819934367708481*^9, 3.819934379603281*^9}, {3.8199959330028057`*^9, 
   3.81999598704078*^9}, {3.819999562597543*^9, 3.819999566205818*^9}, {
   3.8206112812472086`*^9, 3.8206113112540617`*^9}, {3.820611454693607*^9, 
   3.820611499995433*^9}, {3.8206115409233913`*^9, 3.8206115565383825`*^9}, {
   3.8206116010275483`*^9, 3.820611614009818*^9}, {3.8206119622314854`*^9, 
   3.8206120061502485`*^9}, {3.8206121714131565`*^9, 3.820612199085083*^9}, {
   3.820612376803464*^9, 3.8206123776502323`*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"34cfd93d-ddc5-4e6b-baab-f6748509833c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"higher", " ", "level", " ", "parsing", " ", "functions"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.820616298832428*^9, 3.8206163064541616`*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"2d44b05f-be50-4b4f-af84-9d746582035e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findSCFEnergy", "[", "qedict_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"outEns", "=", 
       RowBox[{"{", "}"}]}], ",", " ", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"qedict", "[", 
          RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"outEns", ",", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ImportString", "[", 
             RowBox[{
              RowBox[{"grep", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"qedict", "[", 
                  RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\<!\>\""}], 
               "]"}], ",", " ", "\"\<Table\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], ")"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outEns", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8199124587862244`*^9, 3.8199124849837074`*^9}, {
   3.819914344029793*^9, 3.8199143501279297`*^9}, {3.819929161806882*^9, 
   3.81992918391816*^9}, {3.8199295216353035`*^9, 3.8199295418429956`*^9}, {
   3.819929838712291*^9, 3.819929886063288*^9}, 3.8199300491895323`*^9, {
   3.819930093220522*^9, 3.8199301141565337`*^9}, {3.819930326500477*^9, 
   3.8199303390909104`*^9}, {3.8199329752330375`*^9, 
   3.8199330344488077`*^9}, {3.819995893153846*^9, 3.8199959108815336`*^9}, {
   3.8206371986195145`*^9, 3.8206372056749816`*^9}, {3.820637330513916*^9, 
   3.820637340944825*^9}, {3.821464016831749*^9, 3.8214640367091923`*^9}, {
   3.82146409449438*^9, 3.8214641281500444`*^9}, {3.821467397838796*^9, 
   3.821467435555828*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"6982b430-f773-458a-9cbc-84f00d2dcc1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findRELEnergy", "[", "qedict_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"outEns", "=", 
       RowBox[{"{", "}"}]}], ",", " ", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"qedict", "[", 
          RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"outEns", ",", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ImportString", "[", 
             RowBox[{
              RowBox[{"grep", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"qedict", "[", 
                  RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\<!\>\""}], 
               "]"}], ",", " ", "\"\<Table\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", "5"}], "]"}], "]"}], ")"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outEns", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.819934091198394*^9, 3.8199341135496902`*^9}, {
  3.81999917119345*^9, 3.8199991937055063`*^9}, {3.8200006461144114`*^9, 
  3.8200006499622607`*^9}, {3.8200009809684486`*^9, 3.8200009867752657`*^9}, {
  3.820001018055705*^9, 3.8200010971097927`*^9}, {3.8200011749827085`*^9, 
  3.820001177725198*^9}, {3.8200012363024607`*^9, 3.8200012377167454`*^9}, {
  3.8200016198098125`*^9, 3.8200016260732064`*^9}, {3.8206373504899464`*^9, 
  3.820637386451707*^9}, {3.8214640117127953`*^9, 3.8214640138307185`*^9}, {
  3.8214674414975433`*^9, 3.8214674529003334`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"a2b0a703-cf8f-4e1b-8c2a-f73872f856c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findSCFCell", "[", "qedict_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "outEnergy", ",", " ", "outCells", ",", " ", "listFiles", ",", " ", 
      "i"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{"NEEDS", " ", "WORK"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listFiles", " ", "=", " ", 
      RowBox[{"qedict", "[", 
       RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"outCells", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "listFiles", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"outCells", ",", "\[IndentingNewLine]", 
          RowBox[{"ConstantArray", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ImportString", "[", 
               RowBox[{
                RowBox[{"grepAfter", "[", 
                 RowBox[{
                  RowBox[{"listFiles", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                  "\"\<crystal axes\>\"", ",", " ", "3"}], "]"}], ",", " ", 
                "\"\<Table\>\""}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", 
                RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"qedict", "[", 
               RowBox[{"[", "\"\<alat\>\"", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", "bohr"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"qedict", "[", 
              RowBox[{"[", "\"\<numberOfIterations\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outCells", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.819934091198394*^9, 3.8199341135496902`*^9}, {
   3.81999917119345*^9, 3.8199991937055063`*^9}, {3.819999425111108*^9, 
   3.819999456398301*^9}, {3.819999500326255*^9, 3.8199996201089277`*^9}, {
   3.819999684836708*^9, 3.81999972578032*^9}, {3.819999772803876*^9, 
   3.8199997750913744`*^9}, {3.8214611359066534`*^9, 
   3.8214612029930563`*^9}, {3.821461248347102*^9, 3.821461268564166*^9}, {
   3.821463477886165*^9, 3.821463490044591*^9}, {3.8214692664122953`*^9, 
   3.8214692686454964`*^9}, {3.8214693925154514`*^9, 3.8214694185661755`*^9}, 
   3.8214694591708765`*^9},
 CellLabel->
  "In[261]:=",ExpressionUUID->"3a2ad339-2e88-4f03-8ba3-bf43105843dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findRELCell", "[", "qedict_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "outCells", ",", " ", "listFiles", ",", " ", "i", ",", " ", "j"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listFiles", " ", "=", " ", 
      RowBox[{"qedict", "[", 
       RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"outCells", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "listFiles", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"outCells", ",", "\[IndentingNewLine]", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"ImportString", "[", 
            RowBox[{
             RowBox[{"grepAfter", "[", 
              RowBox[{
               RowBox[{"listFiles", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\<CELL\>\"", ",",
                " ", "3"}], "]"}], ",", " ", "\"\<Table\>\""}], "]"}], ",", 
           " ", "3"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outCells", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.819934091198394*^9, 3.8199341135496902`*^9}, {
   3.81999917119345*^9, 3.8199991937055063`*^9}, {3.819999425111108*^9, 
   3.819999456398301*^9}, {3.819999500326255*^9, 3.8199996201089277`*^9}, {
   3.819999684836708*^9, 3.8199997131242886`*^9}, {3.820609763935794*^9, 
   3.820609764726512*^9}, {3.820609805263194*^9, 3.8206098058777523`*^9}, {
   3.820610832787531*^9, 3.820610840330186*^9}, {3.8206108903226185`*^9, 
   3.820611039936404*^9}, {3.8206111302571397`*^9, 3.8206112035026884`*^9}, {
   3.82061288750299*^9, 3.820612914020089*^9}, 3.820612973579975*^9, {
   3.8206130843221064`*^9, 3.8206130854266148`*^9}, {3.8206149588712525`*^9, 
   3.8206149591655207`*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"9564eb3a-265d-44ee-86e3-49ca0bdebb0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findRELAtoms", "[", "qedict_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "outAtoms", ",", " ", "listFiles", ",", " ", "i", ",", " ", "j"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listFiles", " ", "=", " ", 
      RowBox[{"qedict", "[", 
       RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"outAtoms", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "listFiles", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"outAtoms", ",", "\[IndentingNewLine]", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ImportString", "[", 
             RowBox[{
              RowBox[{"grepAfter", "[", 
               RowBox[{
                RowBox[{"listFiles", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                "\"\<ATOMIC_POSITIONS\>\"", ",", " ", 
                RowBox[{
                 RowBox[{"qedict", "[", 
                  RowBox[{"[", "\"\<numberOfAtoms\>\"", "]"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
              "\"\<Table\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", 
              RowBox[{";;", "4"}]}], "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"qedict", "[", 
             RowBox[{"[", "\"\<numberOfAtoms\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outAtoms", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8206072119613113`*^9, 3.8206072335211134`*^9}, {
   3.8206077076120996`*^9, 3.8206077094758577`*^9}, 3.820613218272958*^9, {
   3.820613377063529*^9, 3.8206134132788444`*^9}, {3.8206139725295563`*^9, 
   3.820614039624482*^9}, {3.820614121240594*^9, 3.820614162070672*^9}, {
   3.8206149309751463`*^9, 3.820614954149825*^9}, {3.8206294639924326`*^9, 
   3.82062946452792*^9}, {3.8218770928555565`*^9, 3.821877099342453*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"6535c5a8-e19e-4075-9462-25bcb7b57680"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findBonds", "[", "qedict_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"crysAtoms", ",", " ", "angAtoms"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "\[LessEqual]", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"qedict", "[", 
         RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToLowerCase", "[", 
           RowBox[{
            RowBox[{"qedict", "[", 
             RowBox[{"[", "\"\<coordinateUnits\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[Equal]", 
          "\"\<(crystal)\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"crysAtoms", " ", "=", " ", 
           RowBox[{
            RowBox[{"qedict", "[", 
             RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"angAtoms", " ", "=", " ", 
           RowBox[{"convAtomsCrysToAng", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"qedict", "[", 
               RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"qedict", "[", 
               RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], "]"}]}], ";"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ToLowerCase", "[", 
           RowBox[{
            RowBox[{"qedict", "[", 
             RowBox[{"[", "\"\<coordinateUnits\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[Equal]", 
          "\"\<(angstrom)\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"angAtoms", " ", "=", " ", 
           RowBox[{
            RowBox[{"qedict", "[", 
             RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"crysAtoms", " ", "=", " ", 
           RowBox[{"convAtomsAngToCrys", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"qedict", "[", 
               RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"qedict", "[", 
               RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], "]"}]}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8208491189951515`*^9, 3.820849248997965*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"8265871a-dd46-4f96-9fcd-ae8a2f53db9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findRELStructure", "[", "qedict_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "outGraphics", ",", " ", "i", ",", " ", "j", ",", " ", "k", ",", 
      "tmpGraphics", ",", " ", "crysAtoms", ",", " ", "angAtoms", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"cellLineThickness", " ", "=", "  ", "0.0075"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"cellLineColor", " ", "=", " ", "Black"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"atomSizeScale", " ", "=", " ", "1.0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"atomOpacity", " ", "=", " ", "1.0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"atomColorAssoc", " ", "=", " ", "elementColor"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"atomRadii", " ", "=", " ", "elementRadius"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outGraphics", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"qedict", "[", 
          RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"outGraphics", ",", " ", 
          RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", " ", 
          RowBox[{"j", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"qedict", "[", 
              RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ToLowerCase", "[", 
               RowBox[{
                RowBox[{"qedict", "[", 
                 RowBox[{"[", "\"\<coordinateUnits\>\"", "]"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[Equal]", 
              "\"\<(crystal)\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"crysAtoms", " ", "=", " ", 
               RowBox[{
                RowBox[{"qedict", "[", 
                 RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"angAtoms", " ", "=", " ", 
               RowBox[{"convAtomsCrysToAng", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"qedict", "[", 
                   RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{"qedict", "[", 
                   RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], "]"}]}], 
              ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ToLowerCase", "[", 
               RowBox[{
                RowBox[{"qedict", "[", 
                 RowBox[{"[", "\"\<coordinateUnits\>\"", "]"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[Equal]", 
              "\"\<(angstrom)\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"angAtoms", " ", "=", " ", 
               RowBox[{
                RowBox[{"qedict", "[", 
                 RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"crysAtoms", " ", "=", " ", 
               RowBox[{"convAtomsAngToCrys", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"qedict", "[", 
                   RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", " ", 
                 RowBox[{
                  RowBox[{"qedict", "[", 
                   RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", " ", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmpGraphics", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"(*", "Cell", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FaceForm", "[", 
               RowBox[{"Directive", "[", 
                RowBox[{"Opacity", "[", "0.", "]"}], "]"}], "]"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"Directive", "[", 
                RowBox[{"cellLineColor", ",", 
                 RowBox[{"Thickness", "[", "cellLineThickness", "]"}]}], 
                "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Parallelepiped", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"qedict", "[", 
                   RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tmpGraphics", " ", "=", " ", 
            RowBox[{"tmpGraphics", "~", "Join", "~", 
             RowBox[{"{", 
              RowBox[{"(*", "Atoms", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"FaceForm", "[", 
               RowBox[{"Directive", "[", 
                RowBox[{"Opacity", "[", "atomOpacity", "]"}], "]"}], "]"}], 
              "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", " ", 
             RowBox[{"k", "\[LessEqual]", " ", 
              RowBox[{
               RowBox[{"qedict", "[", 
                RowBox[{"[", "\"\<numberOfAtoms\>\"", "]"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"tmpGraphics", " ", "=", " ", 
              RowBox[{"tmpGraphics", "~", "Join", "~", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"atomColorAssoc", "[", 
                  RowBox[{"[", 
                   RowBox[{"angAtoms", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", " ", "1"}], "]"}], "]"}], "]"}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Sphere", "[", 
                  RowBox[{
                   RowBox[{"angAtoms", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", " ", 
                    RowBox[{"2", ";;"}]}], "]"}], "]"}], ",", " ", 
                   RowBox[{"atomSizeScale", "*", 
                    RowBox[{"atomRadii", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"angAtoms", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", " ", "1"}], "]"}], "]"}], " ", "]"}], 
                    "]"}]}]}], "]"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"outGraphics", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"Flatten", "[", "tmpGraphics", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outGraphics", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8206148713205976`*^9, 3.82061492793375*^9}, {
   3.82061498209348*^9, 3.820615140731521*^9}, {3.8206154285762005`*^9, 
   3.820615440160443*^9}, {3.8206156108388176`*^9, 3.820615686325515*^9}, {
   3.8206159691078405`*^9, 3.820616036076479*^9}, {3.8206161686329656`*^9, 
   3.8206162074240956`*^9}, {3.8206183168411083`*^9, 3.820618562407137*^9}, {
   3.8206185941185317`*^9, 3.8206186111980224`*^9}, {3.8206186454941444`*^9, 
   3.8206187458535585`*^9}, {3.8206189768113585`*^9, 
   3.8206190430898557`*^9}, {3.8206202062851887`*^9, 3.820620206389283*^9}, {
   3.820621276458897*^9, 3.8206214696797504`*^9}, {3.820623323733249*^9, 
   3.8206233825941453`*^9}, {3.8206234264911776`*^9, 
   3.8206235078098497`*^9}, {3.820623548273204*^9, 3.8206235706486692`*^9}, {
   3.8206273154183073`*^9, 3.8206273890732064`*^9}, {3.820627645838983*^9, 
   3.820627659350788*^9}, {3.820627878692936*^9, 3.820627896315412*^9}, {
   3.8206283285267415`*^9, 3.8206283546473784`*^9}, {3.820628447134774*^9, 
   3.82062846464489*^9}, {3.820628578619342*^9, 3.820628609291355*^9}, 
   3.8206286551163464`*^9, 3.8208492061228323`*^9, {3.8218769281868343`*^9, 
   3.821876929841338*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"7360de02-dc39-4139-8026-4df923c63c72"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Core", " ", "user"}], "-", 
   RowBox[{"end", " ", "functions"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8206163143124733`*^9, 3.820616331901925*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"4f983970-12ec-49df-9407-0d348fe26643"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QEImport", "[", 
   RowBox[{"listFiles_", ",", " ", 
    RowBox[{"type_", ":", "\"\<scf\>\""}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"returnDictionary", ",", " ", "rawInput"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"returnDictionary", " ", "=", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<calcType\>\"", "\[Rule]", "type"}], ",", " ", 
        RowBox[{"\"\<listFiles\>\"", "\[Rule]", " ", "listFiles"}]}], 
       "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "returnDictionary", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.819909483607117*^9, 3.819909581764661*^9}, {
  3.8199096121647816`*^9, 3.819909712715225*^9}, {3.819909768963111*^9, 
  3.8199098137790775`*^9}, {3.8199099615687976`*^9, 3.8199101303675227`*^9}, {
  3.819910176103053*^9, 3.8199101870469904`*^9}, {3.8199290468551073`*^9, 
  3.8199290479836226`*^9}, {3.8199291419671926`*^9, 3.8199291461269693`*^9}, {
  3.8199295717071753`*^9, 3.8199295908423495`*^9}, {3.819930053349309*^9, 
  3.8199300571497593`*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"fda43e8c-9ec5-49e5-8199-56ad0495e351"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"QEParseValues", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QEParseValues", "[", "qedict_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "listFiles", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listFiles", "=", "  ", 
      RowBox[{"qedict", "[", 
       RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", 
       RowBox[{"\"\<kineticEnergyCutoff\>\"", "\[Rule]", "  ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ImportString", "[", 
              RowBox[{
               RowBox[{"grep", "[", 
                RowBox[{"#", ",", " ", "\"\<kinetic-energy cutoff\>\""}], 
                "]"}], ",", " ", "\"\<Table\>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4"}], "]"}], "]"}], ")"}], "&"}], "/@", 
          RowBox[{"(", "listFiles", ")"}]}], ")"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<numberOfAtoms\>\"", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"ImportString", "[", 
            RowBox[{
             RowBox[{"grep", "[", 
              RowBox[{"#", ",", " ", "\"\<number of atoms/cell\>\""}], "]"}], 
             ",", " ", "\"\<Table\>\""}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "5"}], "]"}], "]"}]}], "&"}], "/@", 
        RowBox[{"(", "listFiles", ")"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", 
       RowBox[{"\"\<numberOfElectrons\>\"", "\[Rule]", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ImportString", "[", 
             RowBox[{
              RowBox[{"grep", "[", 
               RowBox[{"#", ",", " ", "\"\<number of electrons\>\""}], "]"}], 
              ",", " ", "\"\<Table\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "5"}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"(", "listFiles", ")"}]}], ")"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", 
       RowBox[{"\"\<numberOfAtomicSpecies\>\"", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ImportString", "[", 
             RowBox[{
              RowBox[{"grep", "[", 
               RowBox[{"#", ",", " ", "\"\<number of atomic types\>\""}], 
               "]"}], ",", " ", "\"\<Table\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "6"}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"(", "listFiles", ")"}]}], ")"}]}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.820634513169462*^9, 3.8206345432398815`*^9}, {
  3.820634588375219*^9, 3.8206345925830393`*^9}, {3.8206347297094283`*^9, 
  3.8206347451977444`*^9}, {3.820634857699978*^9, 3.820634903348655*^9}, {
  3.820634944979631*^9, 3.820634996243861*^9}, {3.820635055938101*^9, 
  3.8206350808423176`*^9}, {3.820635499695281*^9, 3.82063557436724*^9}, {
  3.820637664992819*^9, 3.820637668189814*^9}, {3.820637776087816*^9, 
  3.820637840067932*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"2b694094-95e7-4c64-b63e-8d3115fdddae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"QEEnergy", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "QEEnergy", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Flat\>\"", "\[Rule]", " ", "False"}], ",", 
     RowBox[{"\"\<FastMode\>\"", "\[Rule]", " ", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QEEnergy", "[", 
   RowBox[{"qedict_", ",", " ", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tempAppend", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"QEParseValues", "[", "qedict", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"qedict", ",", " ", "\"\<energy\>\""}], "]"}], " ", "&&", 
        " ", 
        RowBox[{"OptionValue", "[", "\"\<FastMode\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"qedict", "[", 
         RowBox[{"[", "\"\<energy\>\"", "]"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"qedict", "[", 
           RowBox[{"[", "\"\<calcType\>\"", "]"}], "]"}], "\[Equal]", " ", 
          "\"\<scf\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{"tempAppend", " ", "=", " ", 
          RowBox[{
           RowBox[{"findSCFEnergy", "[", 
            RowBox[{"Evaluate", "[", "qedict", "]"}], "]"}], "*", "ry"}]}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"qedict", "[", 
            RowBox[{"[", "\"\<calcType\>\"", "]"}], "]"}], " ", "\[Equal]", 
           " ", "\"\<vc-relax\>\""}], " ", "||", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"qedict", "[", 
            RowBox[{"[", "\"\<calcType\>\"", "]"}], "]"}], " ", "\[Equal]", 
           " ", "\"\<relax\>\""}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"tempAppend", " ", "=", " ", 
          RowBox[{
           RowBox[{"findRELEnergy", "[", 
            RowBox[{"Evaluate", "[", "qedict", "]"}], "]"}], "*", "ry"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Flat\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempAppend", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"tempAppend", ",", " ", "1"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", " ", 
       RowBox[{"\"\<energy\>\"", "\[Rule]", " ", "tempAppend"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", " ", 
       RowBox[{"\"\<numberOfIterations\>\"", "\[Rule]", " ", 
        RowBox[{"Length", "/@", 
         RowBox[{"(", 
          RowBox[{"qedict", "[", 
           RowBox[{"[", "\"\<energy\>\"", "]"}], "]"}], ")"}]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", " ", 
       RowBox[{"\"\<unitsOfEnergy\>\"", "\[Rule]", " ", "\"\<eV\>\""}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "tempAppend", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8199099322984953`*^9, 3.819909956760962*^9}, {
   3.819910139199542*^9, 3.819910156687422*^9}, {3.819910458572433*^9, 
   3.819910458852687*^9}, {3.819910912968051*^9, 3.819910994326812*^9}, {
   3.8199121243155766`*^9, 3.8199121370841455`*^9}, {3.8199122855866632`*^9, 
   3.819912368746188*^9}, {3.819912402402531*^9, 3.819912426657261*^9}, {
   3.8199124888723073`*^9, 3.8199125107203255`*^9}, {3.819930019509581*^9, 
   3.819930022678458*^9}, {3.8199300656694965`*^9, 3.819930074861847*^9}, {
   3.819930127989094*^9, 3.819930148628835*^9}, {3.8199992328484077`*^9, 
   3.8199992917203927`*^9}, {3.819999465776176*^9, 3.8199994850547485`*^9}, {
   3.820000608812072*^9, 3.820000627466666*^9}, {3.8200012673412247`*^9, 
   3.8200012716051683`*^9}, {3.820001396829096*^9, 3.8200013976918793`*^9}, {
   3.820001498226983*^9, 3.820001499098776*^9}, {3.8200015565789986`*^9, 
   3.8200015598019247`*^9}, 3.8200018890720463`*^9, {3.8205965296558933`*^9, 
   3.8205965304556203`*^9}, {3.8205965884724393`*^9, 3.820596650046915*^9}, 
   3.820596737149455*^9, {3.8205970852422466`*^9, 3.820597107872946*^9}, {
   3.8205973478013043`*^9, 3.8205973595821753`*^9}, {3.8205974720470247`*^9, 
   3.8205974726055326`*^9}, {3.8205975359179077`*^9, 
   3.8205975538524466`*^9}, {3.820598855838933*^9, 3.8205988569419346`*^9}, {
   3.82061262268067*^9, 3.820612709366069*^9}, {3.820613145089836*^9, 
   3.8206131772020674`*^9}, {3.8206312046065426`*^9, 
   3.8206312251022787`*^9}, {3.8206312581809177`*^9, 
   3.8206312998527794`*^9}, {3.820633430358263*^9, 3.8206334593006296`*^9}, {
   3.820633495044129*^9, 3.8206335080114264`*^9}, {3.820635162593855*^9, 
   3.8206351657297754`*^9}, {3.820635604031287*^9, 3.8206356778864565`*^9}, {
   3.821372171468093*^9, 3.8213721801685266`*^9}, {3.821459723789465*^9, 
   3.8214597428110065`*^9}, {3.821467965763515*^9, 3.8214680831580887`*^9}, 
   3.821468713727973*^9, {3.822477062603197*^9, 3.822477065601921*^9}, {
   3.822766813163231*^9, 3.822766839440471*^9}, {3.8227668844262867`*^9, 
   3.8227669832550497`*^9}, {3.822769823195341*^9, 3.8227698385462756`*^9}, {
   3.8227703956529074`*^9, 3.8227703964396195`*^9}, {3.8227718917721057`*^9, 
   3.822771893772524*^9}, {3.8227728521888323`*^9, 3.8227729190714693`*^9}, {
   3.8227732189049172`*^9, 3.822773228864853*^9}, {3.8227733947865725`*^9, 
   3.822773435573495*^9}, {3.8227734696620617`*^9, 3.8227735098189206`*^9}, {
   3.822773541301285*^9, 3.8227735889946976`*^9}, {3.822773666690995*^9, 
   3.8227736690767317`*^9}, {3.8227737016292405`*^9, 3.822773807200407*^9}, 
   3.8227738854173894`*^9},ExpressionUUID->"b5b29583-a56f-4317-8772-\
b292a3a6dcc2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "QEStructure", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Flat\>\"", "\[Rule]", " ", "False"}], ",", 
     RowBox[{"\"\<Last\>\"", " ", "\[Rule]", " ", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"QEStructure", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QEStructure", "[", 
   RowBox[{"qedict_", ",", " ", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tempAppend", ",", " ", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"QEParseValues", "[", "qedict", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<numberOfAtoms\>\"", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ImportString", "[", 
              RowBox[{
               RowBox[{"grep", "[", 
                RowBox[{"#", ",", " ", "\"\<number of atoms\>\""}], "]"}], 
               ",", " ", "\"\<Table\>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], ")"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"qedict", "[", 
            RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}], ")"}]}], 
         ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<alat\>\"", " ", "\[Rule]", "  ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ImportString", "[", 
              RowBox[{
               RowBox[{"grep", "[", 
                RowBox[{"#", ",", " ", "\"\<alat\>\""}], "]"}], ",", " ", 
               "\"\<Table\>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], ")"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"qedict", "[", 
            RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}], ")"}]}], 
         ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{
         RowBox[{"ToLowerCase", "[", 
          RowBox[{"qedict", "[", 
           RowBox[{"[", "\"\<calcType\>\"", "]"}], "]"}], "]"}], ",", " ", 
         "\"\<vc-relax\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AssociateTo", "[", 
         RowBox[{"qedict", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<cellUnits\>\"", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ImportString", "[", 
                 RowBox[{
                  RowBox[{"grep", "[", 
                   RowBox[{"#", " ", ",", " ", "\"\<CELL\>\""}], "]"}], ",", 
                  " ", "\"\<Table\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"qedict", "[", 
               RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}], ")"}]}], 
            ")"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<coordinateUnits\>\"", " ", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ImportString", "[", 
              RowBox[{
               RowBox[{"grep", "[", 
                RowBox[{"#", ",", "  ", "\"\<ATOMIC\>\""}], "]"}], ",", " ", 
               "\"\<Table\>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], ")"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"qedict", "[", 
            RowBox[{"[", "\"\<listFiles\>\"", "]"}], "]"}], ")"}]}], 
         ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"qedict", "[", 
         RowBox[{"[", "\"\<calcType\>\"", "]"}], "]"}], "\[Equal]", " ", 
        "\"\<scf\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AssociateTo", "[", 
         RowBox[{"qedict", ",", " ", 
          RowBox[{"\"\<cells\>\"", "\[Rule]", " ", 
           RowBox[{"findRELCell", "[", 
            RowBox[{"Evaluate", "[", "qedict", "]"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tempAppend", " ", "=", " ", "None"}], ";"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qedict", "[", 
         RowBox[{"[", "\"\<calcType\>\"", "]"}], "]"}], " ", "\[Equal]", " ", 
        "\"\<vc-relax\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AssociateTo", "[", 
         RowBox[{"qedict", ",", " ", 
          RowBox[{"\"\<cells\>\"", "\[Rule]", " ", 
           RowBox[{"findRELCell", "[", 
            RowBox[{"Evaluate", "[", "qedict", "]"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"qedict", ",", " ", 
          RowBox[{"\"\<atoms\>\"", "\[Rule]", " ", 
           RowBox[{"findRELAtoms", "[", 
            RowBox[{"Evaluate", "[", "qedict", "]"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tempAppend", " ", "=", 
         RowBox[{"findRELStructure", "[", 
          RowBox[{"Evaluate", "[", "qedict", "]"}], "]"}]}], ";"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qedict", "[", 
         RowBox[{"[", "\"\<calcType\>\"", "]"}], "]"}], " ", "\[Equal]", " ", 
        "\"\<relax\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AssociateTo", "[", 
         RowBox[{"qedict", ",", " ", 
          RowBox[{"\"\<cells\>\"", "\[Rule]", " ", 
           RowBox[{"findSCFCell", "[", 
            RowBox[{"Evaluate", "[", "qedict", "]"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"qedict", ",", " ", 
          RowBox[{"\"\<atoms\>\"", "\[Rule]", " ", 
           RowBox[{"findRELAtoms", "[", 
            RowBox[{"Evaluate", "[", "qedict", "]"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tempAppend", " ", "=", 
         RowBox[{"findRELStructure", "[", 
          RowBox[{"Evaluate", "[", "qedict", "]"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", "  ", 
       RowBox[{"\"\<structures\>\"", " ", "\[Rule]", "  ", "tempAppend"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Flat\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"qedict", "[", 
          RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"qedict", "[", 
            RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], ",", " ", "1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"qedict", "[", 
          RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"qedict", "[", 
            RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], ",", " ", "1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"qedict", "[", 
          RowBox[{"[", "\"\<structures\>\"", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"qedict", "[", 
            RowBox[{"[", "\"\<structures\>\"", "]"}], "]"}], ",", " ", "1"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Last\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"qedict", "[", 
             RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"qedict", "[", 
                 RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AssociateTo", "[", 
               RowBox[{"qedict", ",", " ", 
                RowBox[{"\"\<lastCells\>\"", "\[Rule]", "  ", 
                 RowBox[{
                  RowBox[{"qedict", "[", 
                   RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"qedict", ",", " ", 
                RowBox[{"\"\<lastAtoms\>\"", "\[Rule]", "  ", 
                 RowBox[{
                  RowBox[{"qedict", "[", 
                   RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"qedict", ",", " ", 
                RowBox[{"\"\<lastStructures\>\"", "\[Rule]", "  ", 
                 RowBox[{
                  RowBox[{"qedict", "[", 
                   RowBox[{"[", "\"\<structures\>\"", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}], ";"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AssociateTo", "[", 
               RowBox[{"qedict", ",", " ", 
                RowBox[{"\"\<lastCells\>\"", "\[Rule]", "  ", 
                 RowBox[{"qedict", "[", 
                  RowBox[{"[", "\"\<cells\>\"", "]"}], "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"qedict", ",", " ", 
                RowBox[{"\"\<lastAtoms\>\"", "\[Rule]", "  ", 
                 RowBox[{"qedict", "[", 
                  RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"qedict", ",", " ", 
                RowBox[{"\"\<lastStructures\>\"", "\[Rule]", "  ", 
                 RowBox[{"qedict", "[", 
                  RowBox[{"[", "\"\<structures\>\"", "]"}], "]"}]}]}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "tempAppend", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzWkog3EAx/E1aa4XXihEjporZ40RMcuEF1JatvBCypqjVqZNVsi5tVK0
acrj1ZLj1XJnL6S0ZI6GRUabbDmeUnM2NP/f8+Lb5+U3tV3R2MFmsVjJJLhi
3LWVqmlhMSVxQfn5iKKcaL5v6IXKyNUDqFpKO4LUU40H2v/aGKnvojcor2v5
gOKt/R9YYJOxK4jSenE0tCdsxkEnFZIJOTnRjCW6gAx+5u8oocegV8PuYesg
jJDawgTEofWUcLi3snYrIsosz4yzRt8jbLvsfIL3SWZlNTHmS9wHt0arNFBK
UZOwtllyAE8WjhlVIp4dmnadDpjrVY3VEh9+NYz8+PSMm37yKSzPhP6euWV4
F1Jpgaa8+CYXcXveL4Gh5mCpm5joVZfBa/aM20NsneJ7oIuTlWofoIWLhx1c
2FuxnQ3lwQBj18seD+pcgiIYRU/HtmhooSPOnwJPs2gu9I2nZcCrs9dsOHyh
zYPr8gETbHzXW2CgULsBJzYNVvgPDPAC6g==
  "],
 CellLabel->
  "In[1753]:=",ExpressionUUID->"32ef1ae6-c53d-49d5-b42e-ce05ea2d98cc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Plotting", " ", "functions"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8206304104633837`*^9, 3.8206304283574257`*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"aa50cefc-83df-4f4e-8478-9f58c0f699c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ShowStructures", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShowStructures", "[", 
   RowBox[{"qedict_", ",", " ", 
    RowBox[{"mode_", ":", "\"\<parallel\>\""}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "graphics", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SameQ", "[", 
       RowBox[{
        RowBox[{"ToLowerCase", "[", "mode", "]"}], ",", " ", 
        "\"\<parallel\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QEStructure", "[", "qedict", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graphics", " ", "=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"qedict", "[", 
          RowBox[{"[", "\"\<structures\>\"", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"graphics", "[", 
               RowBox[{"[", "file", "]"}], "]"}], "[", 
              RowBox[{"[", "step", "]"}], "]"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"step", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"graphics", "[", 
               RowBox[{"[", "file", "]"}], "]"}], "]"}], ",", " ", "1"}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"file", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "graphics", "]"}], ",", " ", "1"}], "}"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SameQ", "[", 
       RowBox[{
        RowBox[{"ToLowerCase", "[", "mode", "]"}], ",", " ", 
        "\"\<serial\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QEStructure", "[", 
        RowBox[{"qedict", ",", " ", 
         RowBox[{"\"\<Flat\>\"", "\[Rule]", "True"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graphics", " ", "=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"qedict", "[", 
          RowBox[{"[", "\"\<structures\>\"", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"graphics", "[", 
            RowBox[{"[", "step", "]"}], "]"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"step", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "graphics", "]"}], ",", " ", "1"}], "}"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SameQ", "[", 
       RowBox[{
        RowBox[{"ToLowerCase", "[", "mode", "]"}], ",", " ", "\"\<last\>\""}],
        "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QEStructure", "[", "qedict", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graphics", " ", "=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"qedict", "[", 
          RowBox[{"[", "\"\<structures\>\"", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graphics", " ", "=", " ", 
        RowBox[{"graphics", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"graphics", "[", 
            RowBox[{"[", "step", "]"}], "]"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"step", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "graphics", "]"}], ",", " ", "1"}], "}"}]}],
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8206304305103817`*^9, 3.8206304692527304`*^9}, {
   3.820630591290604*^9, 3.8206306235070095`*^9}, {3.8206307294979324`*^9, 
   3.820631095670769*^9}, {3.8206311383438096`*^9, 3.820631165541503*^9}, {
   3.8206358357000656`*^9, 3.8206358402592573`*^9}, {3.820635938513102*^9, 
   3.820636006072223*^9}, {3.8206360741693335`*^9, 3.8206362081673636`*^9}, {
   3.820636481556531*^9, 3.8206364860766006`*^9}, {3.821208268710168*^9, 
   3.821208346859234*^9}, {3.8214694929559393`*^9, 3.8214694938957253`*^9}, {
   3.82187723134492*^9, 3.821877275333969*^9}, 3.822476842629647*^9, {
   3.82277058338117*^9, 3.8227705869293914`*^9}, {3.823025204156711*^9, 
   3.8230252299736814`*^9}},ExpressionUUID->"1c5ed1d8-ab76-449b-9c25-\
b7f83f9db2bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "ShowEnergies", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ShowEnergies", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", " ", "\"\<Rainbow\>\""}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ShowEnergies", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShowEnergies", "[", 
   RowBox[{"qedict_", ",", " ", 
    RowBox[{"mode_", ":", "\"\<parallel\>\""}], ",", " ", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ens", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SameQ", "[", 
       RowBox[{
        RowBox[{"ToLowerCase", "[", "mode", "]"}], ",", " ", 
        "\"\<parallel\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ens", " ", "=", " ", 
        RowBox[{"QEEnergy", "[", "qedict", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "-", " ", 
             RowBox[{"Min", "[", "#", "]"}]}], "&"}], "/@", "ens"}], ")"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", " ", "16"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Calc. step\>\"", ",", " ", "\"\<Energy/cell (eV)\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SameQ", "[", 
       RowBox[{
        RowBox[{"ToLowerCase", "[", "mode", "]"}], ",", " ", 
        "\"\<serial\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ens", " ", "=", " ", 
        RowBox[{"QEEnergy", "[", 
         RowBox[{"qedict", ",", " ", 
          RowBox[{"\"\<Flat\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ens", "-", " ", 
           RowBox[{"Min", "[", "ens", "]"}]}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", " ", "16"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Calc. step\>\"", ",", " ", "\"\<Energy/cell (eV)\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SameQ", "[", 
       RowBox[{
        RowBox[{"ToLowerCase", "[", "mode", "]"}], ",", " ", "\"\<last\>\""}],
        "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ens", " ", "=", " ", 
        RowBox[{"QEEnergy", "[", 
         RowBox[{"qedict", ",", 
          RowBox[{"\"\<Flat\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ens", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], " ", "-", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"ens", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", " ", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameStyle", "\[Rule]", " ", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", " ", "16"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Step\>\"", ",", " ", "\"\<Energy/cell (eV)\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.820633287039263*^9, 3.8206333472296734`*^9}, {
   3.8206335526829596`*^9, 3.820633557418805*^9}, {3.8206337228986197`*^9, 
   3.8206337350101504`*^9}, {3.820633766193557*^9, 3.820633791464721*^9}, {
   3.8206356969252477`*^9, 3.8206357721308784`*^9}, {3.820635844916887*^9, 
   3.8206359133937993`*^9}, {3.821371317563915*^9, 3.821371534602366*^9}, 
   3.8214636886767807`*^9, {3.8214685709888735`*^9, 3.821468571916715*^9}, {
   3.822476882254055*^9, 3.8224768846522317`*^9}, 3.82247692695868*^9, {
   3.8230690108765173`*^9, 3.8230690118173723`*^9}, {3.823088216296726*^9, 
   3.8230882763974247`*^9}, {3.8230883241828003`*^9, 3.823088347622082*^9}, {
   3.8230883951171875`*^9, 3.82308842737947*^9}},
 CellLabel->
  "In[3418]:=",ExpressionUUID->"a4474aad-dba9-4c13-9aa8-2d0fe7ec70b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ShowKineticEnergyCutoff", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShowKineticEnergyCutoff", "[", "qedict_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ens", ",", " ", "out"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ens", " ", "=", " ", 
      RowBox[{"QEEnergy", "[", "qedict", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ens", " ", "=", " ", 
      RowBox[{"ens", " ", "-", " ", 
       RowBox[{"Min", "[", "ens", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ens", " ", "=", " ", 
      RowBox[{"ens", "/", 
       RowBox[{"qedict", "[", 
        RowBox[{"[", "\"\<numberOfAtoms\>\"", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out", " ", "=", " ", 
      RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"qedict", "[", 
                 RowBox[{"[", "\"\<kineticEnergyCutoff\>\"", "]"}], "]"}], 
                ",", " ", "ens"}], "}"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"All", ",", " ", 
               RowBox[{"{", 
                RowBox[{"0.", ",", " ", "viewRange"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", " ", "16"}], "]"}]}], " ", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Kin. En. Cutoff (Ry)\>\"", ",", " ", 
               "\"\<En. Above Min. (eV/atom)\>\""}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0.1", ",", "  ", "0.01", ",", " ", "0.001", ",", " ", 
              "0.0001"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", " ", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"qedict", "[", 
                 RowBox[{"[", "\"\<kineticEnergyCutoff\>\"", "]"}], "]"}], 
                "]"}], "-", "100"}], ",", " ", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"qedict", "[", 
                 RowBox[{"[", "\"\<kineticEnergyCutoff\>\"", "]"}], "]"}], 
                "]"}], "+", "100"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", " ", "Dashed"}], "]"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"viewRange", ",", 
          RowBox[{"{", 
           RowBox[{
           "0.001", ",", " ", "0.01", ",", " ", "0.1", ",", " ", "1.0", ",", 
            " ", "10."}], "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "out", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.820636994280016*^9, 3.820637031844494*^9}, {
  3.820637551287526*^9, 3.820637598694084*^9}, {3.8206387796832056`*^9, 
  3.820638848329608*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"b43887b6-9fe9-418e-a52d-7779815c269f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "Show2DPhaseDiagram", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Show2DPhaseDiagram", "::", "usage"}], " ", "=", " ", 
   "\"\<Show2DPhaseDiagram[qedict, bulkEnergies, {\\\"Species\\\", min, max}, \
{\\\"Species\\\", min, max}]:=Graphics;\nqedict: variable name used in \
QEEnergies[];\nbulkEnergies: Association of the form <|\\\"S\\\"\[Rule] 10.0, \
\\\"H\\\"\[Rule] 13.6, ...|>, with the Element symbol associated to it's bulk \
elemental phase energy;\nvar1Range (var2Range): List of the form {\\\"H\\\", \
-10, 0}, the x-axis (y-axis) atomic species followed by the range over which \
to plot;\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Show2DPhaseDiagram", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<CheckBulkEnergies\>\"", "\[Rule]", " ", "False"}], ",", " ", 
     RowBox[{"\"\<NoPlot\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Frame\>\"", "\[Rule]", " ", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<FrameStyle\>\"", "\[Rule]", " ", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "16"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<FrameLabel\>\"", "\[Rule]", " ", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<BoundaryStyle\>\"", "\[Rule]", " ", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "Thin"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", " ", "\"\<Rainbow\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PlotLegends\>\"", "\[Rule]", " ", "False"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"Show2DPhaseDiagram", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show2DPhaseDiagram", "[", 
   RowBox[{
   "qedict_", ",", " ", "bulkEnergies_", ",", " ", "var1Range_", ",", " ", 
    "var2Range_", ",", " ", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "lastEns", ",", " ", "\[IndentingNewLine]", "species", ",", " ", 
      "speciesBase", ",", " ", "\[IndentingNewLine]", "curExpr", ",", " ", 
      "expr", ",", " ", "relExpr", ",", "\[IndentingNewLine]", "dummy", ",", 
      "\[IndentingNewLine]", "i", ",", "j", ",", " ", "k", ",", " ", 
      "\[IndentingNewLine]", "numTypes", ",", "\[IndentingNewLine]", 
      "outPlot", ",", " ", "vars"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"QEParseValues", "[", "qedict", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lastEns", " ", "=", " ", 
      RowBox[{"Last", "/@", 
       RowBox[{"(", 
        RowBox[{"QEEnergy", "[", "qedict", "]"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dummy", " ", "=", " ", 
      RowBox[{"QEStructure", "[", 
       RowBox[{"qedict", ",", " ", 
        RowBox[{"\"\<Last\>\"", "\[Rule]", " ", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"species", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Last", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Evaluate", "[", "qedict", "]"}], ")"}], "[", 
           RowBox[{"[", "\"\<atoms\>\"", "]"}], "]"}], ")"}]}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", " ", "All", ",", " ", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"speciesBase", " ", "=", " ", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Flatten", "[", "species", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"SubsetQ", "[", 
         RowBox[{
          RowBox[{"Keys", "[", "bulkEnergies", "]"}], ",", " ", 
          "speciesBase"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "Return", "[", 
        "\"\<Error: Missing atom types as Keys of bulk energies.\>\"", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"numTypes", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", " ", 
          RowBox[{"Length", "[", "speciesBase", "]"}]}], "]"}], ",", " ", 
        RowBox[{"Length", "[", "lastEns", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "lastEns", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", " ", 
          RowBox[{"j", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "speciesBase", "]"}]}], ",", " ", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"numTypes", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"species", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"SameQ", "[", 
                 RowBox[{
                  RowBox[{"speciesBase", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", " ", "#"}], "]"}], 
                "&"}]}], "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "/@", 
           RowBox[{"(", 
            RowBox[{"Transpose", "[", "numTypes", "]"}], ")"}]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}], 
        ">", "2"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "Return", "[", 
        "\"\<Error: More than 2 independent chemical potentials \
detected.\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"relExpr", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"True", ",", " ", 
        RowBox[{"Length", "[", "lastEns", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"expr", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"True", ",", " ", 
        RowBox[{"Length", "[", "lastEns", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "lastEns", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"curExpr", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"lastEns", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", " ", 
          RowBox[{"j", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "speciesBase", "]"}]}], ",", " ", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"curExpr", " ", "-=", " ", 
            RowBox[{
             RowBox[{"numTypes", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "*", " ", 
             RowBox[{"bulkEnergies", "[", 
              RowBox[{"[", 
               RowBox[{"speciesBase", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"curExpr", " ", "-=", " ", 
            RowBox[{
             RowBox[{"numTypes", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "*", " ", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"\"\<\[Mu]\>\"", "<>", 
               RowBox[{"speciesBase", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"expr", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "curExpr"}], ";"}]}],
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"Length", "[", "lastEns", "]"}], "-", "1"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"i", "+", "1"}]}], ",", " ", 
          RowBox[{"j", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "lastEns", "]"}]}], ",", " ", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"relExpr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"relExpr", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "&&", " ", 
             RowBox[{
              RowBox[{"expr", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "<", " ", 
              RowBox[{"expr", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"relExpr", "[", 
             RowBox[{"[", "j", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"relExpr", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "&&", " ", 
             RowBox[{
              RowBox[{"expr", "[", 
               RowBox[{"[", "j", "]"}], "]"}], " ", "<", " ", 
              RowBox[{"expr", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"relExpr", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Reduce", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<\[Mu]\>\"", "<>", 
             RowBox[{"var2Range", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", "Reals"}], 
          "]"}], "]"}], "&"}], "/@", "relExpr"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", " ", 
       RowBox[{"\"\<formationEnergies\>\"", " ", "\[Rule]", " ", "expr"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"qedict", ",", " ", 
       RowBox[{
       "\"\<relativeStability\>\"", " ", "\[Rule]", " ", "relExpr"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<NoPlot\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "relExpr", "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"outPlot", " ", "=", " ", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{"relExpr", ",", "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<\[Mu]\>\"", "<>", 
             RowBox[{"var1Range", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"var1Range", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
           RowBox[{"var1Range", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<\[Mu]\>\"", "<>", 
             RowBox[{"var2Range", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"var2Range", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
           RowBox[{"var2Range", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"OptionValue", "[", "\"\<Frame\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"OptionValue", "[", "\"\<FrameStyle\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"False", ",", 
              RowBox[{"OptionValue", "[", "\"\<FrameLabel\>\"", "]"}]}], " ", 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"\"\<\[Mu]_\>\"", ",", 
                 RowBox[{"var1Range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<>", " ", 
               "\"\< (\>\"", "<>", 
               RowBox[{
                RowBox[{"Evaluate", "[", "qedict", "]"}], "[", 
                RowBox[{"[", "\"\<unitsOfEnergy\>\"", "]"}], "]"}], "<>", 
               "\"\<)\>\""}], ",", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{"\"\<\[Mu]_\>\"", ",", 
                 RowBox[{"var2Range", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<>", " ", 
               "\"\< (\>\"", "<>", 
               RowBox[{
                RowBox[{"Evaluate", "[", "qedict", "]"}], "[", 
                RowBox[{"[", "\"\<unitsOfEnergy\>\"", "]"}], "]"}], "<>", 
               "\"\<)\>\""}]}], "}"}], ",", 
            RowBox[{"OptionValue", "[", "\"\<FrameLabel\>\"", "]"}]}], "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLegends", "\[Rule]", " ", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"False", ",", 
              RowBox[{"OptionValue", "[", "\"\<PlotLegends\>\"", "]"}]}], " ",
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<Structure: \>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "lastEns", "]"}], "]"}]}], ",", 
            RowBox[{"OptionValue", "[", "\"\<PlotLegends\>\"", "]"}]}], "]"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"BoundaryStyle", "\[Rule]", " ", 
         RowBox[{"OptionValue", "[", "\"\<BoundaryStyle\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", "outPlot", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.822766601433523*^9, 3.8227666212015767`*^9}, {
   3.8227667276888123`*^9, 3.8227667291281185`*^9}, {3.8227697378977165`*^9, 
   3.822769792224512*^9}, {3.8227698506330147`*^9, 3.8227698702076607`*^9}, {
   3.822770020166691*^9, 3.8227700285834656`*^9}, {3.822770060742921*^9, 
   3.8227701332458363`*^9}, {3.822771328553485*^9, 3.8227713602681365`*^9}, {
   3.8227716920940404`*^9, 3.8227717102145076`*^9}, {3.822771757716284*^9, 
   3.822771757907457*^9}, {3.8227738279153523`*^9, 3.82277382864802*^9}, {
   3.822774087399711*^9, 3.82277410882082*^9}, {3.8227741693962774`*^9, 
   3.822774219547621*^9}, {3.8227744933609366`*^9, 3.822774606564663*^9}, {
   3.822774661287445*^9, 3.8227750765071898`*^9}, {3.8227751488756533`*^9, 
   3.822775177194741*^9}, {3.8227752322907124`*^9, 3.8227753055923977`*^9}, {
   3.822775344976879*^9, 3.822775402866171*^9}, {3.8227754362891445`*^9, 
   3.8227756302768345`*^9}, {3.8227824643384156`*^9, 3.822782563295309*^9}, {
   3.8227826250469584`*^9, 3.822782651043186*^9}, {3.8227827351496696`*^9, 
   3.8227828624284525`*^9}, {3.8227829382999706`*^9, 3.822782952100336*^9}, {
   3.822783144530114*^9, 3.822783158728719*^9}, {3.8227834626155825`*^9, 
   3.8227835277484617`*^9}, 3.8230081722001495`*^9, 3.82301347488094*^9, 
   3.823016604735402*^9, {3.823016652701431*^9, 3.8230166777896338`*^9}, {
   3.823016902499417*^9, 3.823016910427682*^9}, 3.8230171632483873`*^9, {
   3.8230171948161755`*^9, 3.8230172144809847`*^9}, {3.823017264392926*^9, 
   3.823017458186833*^9}, {3.823017515277732*^9, 3.823017532237503*^9}, {
   3.8230175622685213`*^9, 3.8230176916189647`*^9}, {3.823017816618896*^9, 
   3.823017922206175*^9}, {3.823019545745844*^9, 3.823019551488168*^9}, {
   3.823019582056714*^9, 3.8230196260081263`*^9}, {3.8230196644630256`*^9, 
   3.823019706782441*^9}, {3.8230201265797777`*^9, 3.8230201461222315`*^9}, {
   3.8230213759181805`*^9, 3.8230213763105373`*^9}, 3.8230214217994986`*^9, {
   3.8230214854364743`*^9, 3.8230214855966196`*^9}, {3.8230215191483665`*^9, 
   3.8230215193165193`*^9}, {3.8230215694811063`*^9, 3.823021664621044*^9}, {
   3.82302363088062*^9, 3.823023643086224*^9}, {3.8230237914544673`*^9, 
   3.823023842308544*^9}, {3.8230256610357943`*^9, 3.823025686847773*^9}, {
   3.8230258676739216`*^9, 3.8230258733762045`*^9}, {3.823025951832328*^9, 
   3.8230260265829067`*^9}, {3.823026059632629*^9, 3.8230260605904975`*^9}, 
   3.8230260982792015`*^9, {3.8230261896519947`*^9, 3.823026236894113*^9}, {
   3.8230262767882023`*^9, 3.8230263672863274`*^9}, {3.823026415227882*^9, 
   3.8230264551823397`*^9}, {3.8230265043942657`*^9, 
   3.8230265183290715`*^9}, {3.823026562867326*^9, 3.8230268593735228`*^9}, {
   3.823026902036584*^9, 3.8230269208929257`*^9}, {3.823026956486333*^9, 
   3.8230270178760004`*^9}, {3.8230270662935867`*^9, 3.823027067117881*^9}, {
   3.823027210492764*^9, 3.8230272285125294`*^9}, {3.823027329139097*^9, 
   3.823027544910823*^9}, {3.8230288325616655`*^9, 3.8230291654869595`*^9}, {
   3.8230292003995953`*^9, 3.8230293458280554`*^9}, {3.8230293957470493`*^9, 
   3.8230294672432337`*^9}, {3.823030995340521*^9, 3.823030996700755*^9}, {
   3.8230312235874834`*^9, 3.823031224810593*^9}, {3.82303127595578*^9, 
   3.823031305792375*^9}, {3.8230314100023003`*^9, 3.823031478199602*^9}, {
   3.8230315134004297`*^9, 3.823031530965331*^9}, {3.8230315666720114`*^9, 
   3.8230317067003775`*^9}, {3.8230365507254972`*^9, 3.823036663059335*^9}, 
   3.8230367289721737`*^9, 3.8230367715949974`*^9},
 CellLabel->
  "In[2579]:=",ExpressionUUID->"5ecb5b05-b798-4b97-8a88-6e906c26c542"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "-"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "-"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "-"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MODULE", " ", "ENDS"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8199094734471903`*^9, 3.8199094761656656`*^9}, {
   3.820616249839836*^9, 3.820616251631463*^9}, 3.8206163388461795`*^9},
 CellLabel->
  "In[282]:=",ExpressionUUID->"d3aef869-1744-400f-92f0-889971f4b74f"]
},
WindowSize->{1099, 827},
WindowMargins->{{-28, Automatic}, {Automatic, 38}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b915bdb4-b362-4e6d-9356-edb84b4bb89f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 785, 25, 86, "Input",ExpressionUUID->"168efd4a-8366-436a-b2f5-b29f54c2fae9"],
Cell[1346, 47, 174, 4, 28, "Input",ExpressionUUID->"629612a0-71a5-4b6e-bcb0-9d7953315856"],
Cell[1523, 53, 1045, 21, 257, "Input",ExpressionUUID->"b43fd578-ef3f-4781-a934-80adf8bf99a1"],
Cell[2571, 76, 234, 5, 28, "Input",ExpressionUUID->"1287f675-a785-4403-9ec7-dac1eb49d413"],
Cell[2808, 83, 923, 19, 28, "Input",ExpressionUUID->"596a36f0-2c88-4af0-97dc-e369b665b813"],
Cell[3734, 104, 758, 16, 28, "Input",ExpressionUUID->"14239965-603b-4c28-a239-455c47d5e2ec"],
Cell[4495, 122, 270, 6, 28, "Input",ExpressionUUID->"2640ca51-c79c-457d-bfa0-1640442cbf0f"],
Cell[4768, 130, 390, 9, 48, "Input",ExpressionUUID->"1dc5c2eb-8cbe-4d86-a6a0-164ac847aa77"],
Cell[5161, 141, 905, 25, 28, "Input",ExpressionUUID->"71ce3c97-613c-4bfe-bfba-98b0464ca09b"],
Cell[6069, 168, 895, 25, 28, "Input",ExpressionUUID->"e36431ff-1eac-4ceb-a97a-88f641eef4e4"],
Cell[6967, 195, 254, 5, 28, "Input",ExpressionUUID->"6da9df1f-685d-42a3-b7db-18e07e84314d"],
Cell[7224, 202, 1695, 41, 200, "Input",ExpressionUUID->"0069d8a1-418b-4e2f-9dee-3e5f8e16cdec"],
Cell[8922, 245, 2590, 56, 238, "Input",ExpressionUUID->"34cfd93d-ddc5-4e6b-baab-f6748509833c"],
Cell[11515, 303, 271, 6, 28, "Input",ExpressionUUID->"2d44b05f-be50-4b4f-af84-9d746582035e"],
Cell[11789, 311, 2252, 50, 124, "Input",ExpressionUUID->"6982b430-f773-458a-9cbc-84f00d2dcc1c"],
Cell[14044, 363, 2080, 47, 124, "Input",ExpressionUUID->"a2b0a703-cf8f-4e1b-8c2a-f73872f856c7"],
Cell[16127, 412, 2897, 65, 238, "Input",ExpressionUUID->"3a2ad339-2e88-4f03-8ba3-bf43105843dc"],
Cell[19027, 479, 2249, 48, 200, "Input",ExpressionUUID->"9564eb3a-265d-44ee-86e3-49ca0bdebb0d"],
Cell[21279, 529, 2519, 56, 219, "Input",ExpressionUUID->"6535c5a8-e19e-4075-9462-25bcb7b57680"],
Cell[23801, 587, 3314, 80, 238, "Input",ExpressionUUID->"8265871a-dd46-4f96-9fcd-ae8a2f53db9f"],
Cell[27118, 669, 9634, 201, 732, "Input",ExpressionUUID->"7360de02-dc39-4139-8026-4df923c63c72"],
Cell[36755, 872, 289, 7, 28, "Input",ExpressionUUID->"4f983970-12ec-49df-9407-0d348fe26643"],
Cell[37047, 881, 1248, 27, 86, "Input",ExpressionUUID->"fda43e8c-9ec5-49e5-8199-56ad0495e351"],
Cell[38298, 910, 3586, 87, 162, "Input",ExpressionUUID->"2b694094-95e7-4c64-b63e-8d3115fdddae"],
Cell[41887, 999, 6260, 125, 447, "Input",ExpressionUUID->"b5b29583-a56f-4317-8772-b292a3a6dcc2"],
Cell[48150, 1126, 12407, 287, 1017, "Input",ExpressionUUID->"32ef1ae6-c53d-49d5-b42e-ce05ea2d98cc"],
Cell[60560, 1415, 242, 5, 28, "Input",ExpressionUUID->"aa50cefc-83df-4f4e-8478-9f58c0f699c6"],
Cell[60805, 1422, 5347, 117, 713, "Input",ExpressionUUID->"1c5ed1d8-ab76-449b-9c25-b7f83f9db2bc"],
Cell[66155, 1541, 6366, 142, 808, "Input",ExpressionUUID->"a4474aad-dba9-4c13-9aa8-2d0fe7ec70b8"],
Cell[72524, 1685, 4204, 96, 485, "Input",ExpressionUUID->"b43887b6-9fe9-418e-a52d-7779815c269f"],
Cell[76731, 1783, 19039, 413, 1473, "Input",ExpressionUUID->"5ecb5b05-b798-4b97-8a88-6e906c26c542"],
Cell[95773, 2198, 812, 25, 86, "Input",ExpressionUUID->"d3aef869-1744-400f-92f0-889971f4b74f"]
}
]
*)

